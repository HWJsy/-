{% extends "base.html" %}

{% block title %}é—®å·ç­”å·è¯¦æƒ… - å¾®è°ƒæŸ¥ç³»ç»Ÿ{% endblock %}

{% block content %}
<div class="container">
    <h2>{{ survey.title }}</h2>
    <p style="color: #666;">{{ survey.description }}</p>

    <h3 style="margin-top: 2em;">ğŸ“Š ç»Ÿè®¡ä¿¡æ¯</h3>
    {% for stat in statistics %}
        <div style="margin-bottom: 1.5em;">
            <p><strong>{{ loop.index }}. {{ stat.content }}</strong></p>
            {% if stat.type in ['single', 'multiple', 'true_false'] %}
                <ul style="list-style: none; padding-left: 1em;">
                    {% for item in stat.result %}
                        <li>{{ item.label }}ï¼š{{ item.count }} äºº</li>
                    {% endfor %}
                </ul>
            {% elif stat.type == 'text' %}
                <p>å…±æœ‰ {{ stat.count }} æ¡æ–‡å­—ç­”å¤ã€‚</p>
            {% endif %}
        </div>
    {% endfor %}

    <h3 style="margin-top: 2em;">ğŸ“„ æ‰€æœ‰ç­”å·</h3>
    {% for answer in answers %}
        <div style="border: 1px solid #ddd; padding: 1em; margin-bottom: 1em; border-radius: 6px; background: #fafafa;">
            <p style="font-size: 0.9em; color: #888;">ğŸ†” ç”¨æˆ· IDï¼š{{ answer.user_id }}</p>
            <ul style="list-style: none; padding-left: 1em;">
                {% for q in survey.questions %}
                    <li style="margin-bottom: 0.5em;">
                        <strong>{{ loop.index }}. {{ q.content }}</strong><br>
                        {% set val = answer.answers[q.id] %}
                        {% if q.type == 'single' %}
                            {{ q.options[val] if val is not none else 'æœªä½œç­”' }}
                        {% elif q.type == 'multiple' %}
                            {% if val %}
                                {% set option_texts = [] %}
                                {% for i in val %}
                                  {% set _ = option_texts.append(q.options[i | int]) %}
                                {% endfor %}
                                {{ option_texts | join(', ') }}
                            {% else %}
                                æœªä½œç­”
                            {% endif %}
                        {% elif q.type == 'true_false' %}
                            {{ 'æ˜¯' if val else 'å¦' }}
                        {% elif q.type == 'text' %}
                            {{ val or 'æœªä½œç­”' }}
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>
        </div>
    {% endfor %}
</div>
{% endblock %}
